# Rayleigh-Benard Convection with GQL
This is a test for the `GQLProjection` operator for Dedalus. It validates the operator against data generated by Curtis Saxton using an older version of GQL. 

## To run
Use the `rayleigh_benard_GQL.py` script, changing the `Lambda_x` and `Lambda_y`. 
All analysis assumes runs are in a subdirectory `python/runs/`. 
Copy `rayleigh_benard_GQL.py` to subdirectories for each run (GQL, DNS, etc).

Use `plot_ke.py` with two arguments: one of the below validation `.dat` files, second a `scalar_s1.h5` file from `rayleigh_benard_GQL.py`. This will return a single comparison of kinetic energy between the validation data and the GQLProjection computed data.

`plot_mult_ke.py` assumes the existence of data for DNS, L0 (Lambda = 0), L1, and L5 in `runs/` subdirectory, and will plot all of them against the validation data.

## Validation data
All data from Curtis Saxton. Text files with two columns: time, Kinetic energy

* `fig_kinetic_t_eps0.4.dat`: DNS at epsilon = 0.4
* `fig_kinetic_t_eps0.4_L0.dat`: QL at epsilon = 0.4
* `fig_kinetic_t_eps0.4_L1.dat`: GQL Lambda = 1 at epsilon = 0.4
* `fig_kinetic_t_eps0.4_L5.dat`: GQL Lambda = 5 at epsilon = 0.4

## Notes
* `fingerprint.py` is Curtis's original script. It uses the same equation formulation as the d2 RBC example.
* `rayleigh_benard_2.py` is my script to reproduce it with our new GQL tools.
* Need to use MCNAB2 and a `max_dt` greater that about 1 to reproduce Curtis's fast approach to the straight roll solution
